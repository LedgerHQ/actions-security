
name: "[Ledger Security] JFrog Login"
author: LedgerHQ
description: |
  The `jfrog-login` GitHub Action facilitates a secure login to Ledger's JFrog platform, including services like Artifactory and Xray. 
  By using OIDC authentication, this action ensures secure access to manage artifacts and interact with JFrog's APIs and CLI.

outputs:
  oidc-token:
    description: "OIDC token generated by JFrog CLI for secure API/CLI interactions, using the Setup JFrog CLI step with the configured oidc-provider-name."
    value: ${{ steps.setup-jfrog-cli.outputs.oidc-token }}
  oidc-user:
    description: "Username extracted from the OIDC token during authentication."
    value: ${{ steps.setup-jfrog-cli.outputs.oidc-user }}
  jfrog-url:
    description: "Base URL of Ledger's JFrog platform to be used for subsequent API/CLI operations."
    value: "https://jfrog.ledgerlabs.net"

runs:
  using: "composite"
  steps:
    - uses: jfrog/setup-jfrog-cli@v4
      id: setup-jfrog-cli
      env:
        JF_URL: "https://jfrog.ledgerlabs.net"
      with:
        oidc-provider-name: github-oidc
        oidc-audience: jfrog-github
